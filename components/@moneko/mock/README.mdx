---
type: '@moneko'
title: mock
subtitle: Mockæ•°æ®
icon: ğŸ“š
order: 4
---

# @moneko/mock

> åœ¨é¡¹ç›®å¯åŠ¨ç›®å½• mock æ–‡ä»¶å¤¹ä¸‹åˆ›å»º mock è„šæœ¬ï¼Œè¾¾åˆ°æ¨¡æ‹Ÿå“åº”æ•°æ®çš„æ•ˆæœ

## å‡½æ•°æ–¹å¼

> (req: RequestFormData, res: Response) => void

```typescript
import type { MockConfiguration } from '@moneko/mock';

const conf: MockConfiguration = {
  'GET /api/account': (req, res) => {
    const resp = {
      success: true,
      message: 'è¯·æ±‚æˆåŠŸ',
      result: {
        inme: 'äººå¤§',
        effte: '2022/7/1',
      },
    };

    res.status(200).send(resp);
  },
};

export default conf;
```

### è·å– Restful Api å‚æ•°

```typescript
import type { MockConfiguration } from '@moneko/mock';

const conf: MockConfiguration = {
  'GET /api/account/:id': (req, res) => {
    const resp = {
      success: true,
      message: 'è¯·æ±‚æˆåŠŸ',
      result: {
        id: req.params.id,
        csaa: 'äººé¢',
        currency: req.params.id,
        effee: '2022/7/1',
      },
    };

    res.status(200).send(resp);
  },
};

export default conf;
```

### è·å– POST è¯·æ±‚ä½“æ•°æ®

```typescript
import type { MockConfiguration } from '@moneko/mock';

const conf: MockConfiguration = {
  'POST /api/login_by_username': (req, res) => {
    const resp = {
      status: 200,
      message: 'è¯·æ±‚æˆåŠŸ',
      result: {
        password: req.body.password,
        username: req.body.username,
      },
    };

    res.status(resp.status).send(resp);
  },
};

export default conf;
```

### æ¨¡æ‹Ÿä¸Šä¼ æ–‡ä»¶ï¼Œè¿”å›æ–‡ä»¶ base64

```typescript
import type { MockConfiguration } from '@moneko/core';

const conf: MockConfiguration = {
  'POST /api/upload_file': (req, res) => {
    const { files } = req;

    const strBase64 = Buffer.from(files[0].buffer).toString('base64');

    const resp = {
      status: 200,
      message: 'ä¸Šä¼ æˆåŠŸ',
      result: 'data:image/jpeg;base64,' + strBase64,
    };

    res.status(resp.status).send(resp);
  },
};

export default conf;
```

### ä½¿ç”¨ YApi JSON Schema ç”Ÿæˆæ•°æ®

```typescript
import { yApiSchemaMock } from '@moneko/mock';
import type { MockConfiguration } from '@moneko/mock';

const getYApiOption = (id: string) => {
  return {
    // yapi host
    host: 'http://yapihost',
    // yapi open api token
    token: 'yapi open api token',
    // yapi æ¥å£id
    id,
  };
};

const conf: MockConfiguration = {
  'POST /getids/list': async (req, res) => {
    const mockData = await yApiSchemaMock(getYApiOption('7610'), {
      result: {
        page: req.body.pageNum,
        itemsPerPage: req.body.pageSize,
        keyword: req.body.keyword,
      },
    });

    res.status(200).send(mockData);
  },
};

export default conf;
```

### ä½¿ç”¨ YApi é«˜çº§ Mock

```typescript
import { yApiMock } from '@moneko/mock';
import type { MockConfiguration, YApiOption } from '@moneko/mock';

const yApi: YApiOption = {
  // yapi host
  host: 'http://yapihost:8080',
  projectId: 143,
  pathRewrite: '^/api/',
};

const conf: MockConfiguration = {
  'POST /api/getids/list': async (req, res) => {
    // æ­¤æ—¶ mockData å°†æ˜¯æ¥è‡ª POST http://yapihost:8080/mock/143/getids/list å“åº”çš„æ•°æ®
    const resp = await yApiMock(req, yApi);

    res.status(200).send(resp);
  },
};

export default conf;
```

## KV æ–¹å¼ `Record<string, any>`

```typescript
import type { MockConfiguration } from '@moneko/mock';

const conf: MockConfiguration = {
  'POST /api/use/fun': {
    status: 200,
    message: 'ä¸Šä¼ æˆåŠŸ',
    effectiveDate: '2022/7/1',
  },
};

export default conf;
```
