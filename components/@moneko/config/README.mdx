---
type: å·¥ç¨‹é…ç½®
title: å·¥ç¨‹é…ç½®
subtitle: '@moneko/core'
icon: ğŸ”§
order: 10
---

# é…ç½®é¡¹

> é€‚ç”¨äºä½¿ç”¨ `@moneko/cli` åˆ›å»ºçš„é¡¹ç›®
> å¯ä»¥åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `config/` æ–‡ä»¶å¤¹ä¸­è¿›è¡Œä»¥ä¸‹é…ç½®

[1]: https://swc.rs/docs/configuration/minification#jscminifycompress 'SwcOptions'
[2]: https://terser.org/docs/api-reference#compress-options 'TerserOptions'

## ConfigType

| å±æ€§              | è¯´æ˜                                              | ç±»å‹                                                                                            | é»˜è®¤å€¼             |
| ----------------- | ------------------------------------------------- | ----------------------------------------------------------------------------------------------- | ------------------ |
| clean             | æ¸…é™¤è¿‡æ—¶çš„æ‰“åŒ…æ–‡ä»¶                                | boolean                                                                                         | true               |
| compiler          | ç¼–è¯‘æ–¹å¼                                          | swc\|tsc                                                                                        | swc                |
| swcrc             | swc é…ç½®é¡¹                                        | SwcConfig \| ((isDev: boolean) => SwcConfig)                                                    | -                  |
| entry             | é¢å¤–çš„ entry, æ¯”å¦‚å…¼å®¹ es10 çš„ object.fromentries | `Record<string, string>`                                                                          | -                  |
| minifier          | jsã€css å‹ç¼©é…ç½®                                  | \{ type?: swc\|tsc; options?: [SwcOptions][1] \| [TerserOptions][2]; css?: cssnano \| parcelCss} | -                  |
| env               | ç¯å¢ƒå˜é‡, å¯é€šè¿‡ process.env è·å–                 | `Record<string, any>`                                                                             | -                  |
| sourceMap         | sourceMap é…ç½®                                    | SourceMapDevToolPluginOptions \| false                                                          | -                  |
| devtool           | devtool é…ç½®                                      | Configuration['devtool']                                                                        | -                  |
| alias             | è·¯å¾„åˆ«åæ˜ å°„                                      | Record\<string, string>                                                                          | -                  |
| basename          | æ ¹è·¯ç”±                                            | string                                                                                          | /                  |
| publicPath        | èµ„æºæ ¹è·¯å¾„                                        | string                                                                                          | auto               |
| rem               | è®¾ç½®ä¸è®¾è®¡å›¾ç›¸åŒ¹é…çš„rem                           | \{designSize: number}                                                                            | \{designSize: 1680} |
| fallbackCompPath  | è‡ªå®šä¹‰å®¹é”™ç»„ä»¶è·¯å¾„                                | string                                                                                          | -                  |
| modifyVars        | less å…¨å±€å˜é‡                                     | `Record<string, string>`                                                                          | -                  |
| prefixCls         | ç±»åå‰ç¼€                                          | string                                                                                          | n                  |
| moduleRules       | è‡ªå®šä¹‰ webpack module rules                       |                                                                                                 | -                  |
| cssModules        | node_modules ä¸­, éœ€è¦å¼€å¯ cssModules çš„æ¨¡å—       | string[]                                                                                        | -                  |
| importOnDemand    | æŒ‰éœ€å¼•å…¥                                          | SwcImportOnDemandTransform \| TsImportPlugin.Options                                            | -                  |
| proxy             | æœåŠ¡å™¨ä»£ç†                                        | `Record<string, string>`                                                                          | -                  |
| cacheDirectory    | è‡ªå®šä¹‰ç¼“å­˜ç›®å½•ï¼Œä¸º false æ—¶ï¼Œä¸ä½¿ç”¨ç¼“å­˜           | string \| false                                                                                 | -                  |
| devServer         | å¼€å‘æœåŠ¡å™¨è®¾ç½®                                    | `Record<string, string>`                                                                          | -                  |
| assetHtml         | è‡ªå®šä¹‰æ’å…¥ html çš„ js å’Œ css                      | AssetHtmlOptions[]                                                                              | -                  |
| htmlPluginOption  | HtmlWebpackPlugin Option                          | HtmlWebpackPluginOptions                                                                        | -                  |
| routerMode        | è·¯ç”±æ¨¡å¼                                          | hash \| browser \| memory                                                                       | browser            |
| plugins           | webpack æ’ä»¶                                      |                                                                                                 | -                  |
| splitChunk        | å¯¹ç”Ÿäº§ chunk è¿›è¡Œæ‹†åˆ†                             | false \| OptimizationSplitChunksOptions                                                         | -                  |
| output            | ç¼–è¯‘è¾“å‡ºè·¯å¾„                                      | string                                                                                          | -                  |
| runtimeChunk      | æ‹†åˆ† runtime                                      | boolean\|single \| multiple\| \{ name?: string \| Function };                                    | -                  |
| moduleFederation  | æ¨¡å—è”é‚¦                                          | ModuleFederationOption[]                                                                        | -                  |
| externals         | è·³è¿‡ç¼–è¯‘çš„æ¨¡å—                                    | string[]                                                                                        | -                  |
| rulesInclude      | éœ€è¦è¿›å…¥åˆ°è§„åˆ™çš„æ¨¡å—æˆ–è€…ä½ç½®                      | \{ less?: string[]; css?: string[]; js?: string[]; media?: string[]; fonts?: string[]; }         | -                  |
| bundleAnalyzer    | jsæ‰“åŒ…ä½“ç§¯åˆ†æ                                    | \{ analyzerMode: string; reportFilename: string; openAnalyzer: false }                           | -                  |
| prefixJsLoader    | è§£æjs/tsçš„å‰ç½®loader                             | -                                                                                               | -                  |
| bar               | æ˜¯å¦æ‰“åŒ…æ˜¾ç¤ºè¿›åº¦æ¡                                | -                                                                                               | true               |
| theme             | è®¾ç½®ä¸»é¢˜, å¯ä»¥åœ¨ `@app/info` ä¸­è·å–å€¼             | -                                                                                               | -                  |
| seo               | é…ç½®seoä¼˜åŒ–                                       | \{domain: string; nojekyll?: boolean; path?: string;}                                            | true               |
| done              | æ‰“åŒ…å®Œæˆæ‰§è¡Œçš„å›è°ƒ                                | () => void                                                                                      | -                  |
| mdx               | mdx loaderçš„é…ç½®é¡¹                                | MDXOptions                                                                                      | -                  |
| jsxDomExpressions | ä½¿ç”¨solidjsæ—¶jsx-dom-expressionsçš„é…ç½®é¡¹          | JsxDomExpressions                                                                               | -                  |
| virtualModule     | è‡ªå®šä¹‰è™šæ‹Ÿæ¨¡å—                                    | `Record<string, string \| object>`                                                                | -                  |
| normalizeCss      | æ˜¯å¦ä½¿ç”¨ normalize css                            | boolean                                                                                         | true               |


### SwcOptions

> [SwcOptions][1]

### TerserOptions

> [TerserOptions][2]

## æŒ‰éœ€å¯¼å…¥ `swc`

> ä½¿ç”¨ swc æ—¶çš„æŒ‰éœ€å¯¼å…¥é…ç½® importOnDemand: \{ 'åº“å': \{...é…ç½®é¡¹} }

### SwcImportOnDemandTransform

| å±æ€§                  | è¯´æ˜                                                                            | ç±»å‹                  | é»˜è®¤å€¼  |
| --------------------- | ------------------------------------------------------------------------------- | --------------------- | ------- |
| transform             | è¦ä½¿ç”¨çš„åº“åç§°ï¼Œè€Œä¸æ˜¯å¯¼å…¥è¯­å¥ä¸­æŒ‡å®šçš„åº“åç§°ã€‚`${member}` æ˜¯æ›¿æ¢çš„æˆå‘˜          | string                | -       |
| style                 | è®¾ç½®è½¬æ¢æ—¶éœ€è¦å•ç‹¬å¯¼å…¥çš„æ ·å¼ï¼Œ`${member}` æ˜¯æ›¿æ¢çš„æˆå‘˜                          | `string` \|`boolean`  | `false` |
| skipDefaultConversion | å½“è®¾ç½®ä¸º true æ—¶ï¼Œå°†ä¿ç•™ `import { Button }` è¯­æ³•ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸º `import Button` | boolean               | `false` |
| preventFullImport     | å½“é‡åˆ°ä¼šå¯¼è‡´å¯¼å…¥æ•´ä¸ªæ¨¡å—æ—¶ï¼Œæ˜¯å¦æŠ›å‡º                                            | boolean               | `true`  |
| memberTransformers    | æˆå‘˜è½¬æ¢è§„åˆ™                                                                    | `MemberTransformer`[] | []      |

### MemberTransformer

| å±æ€§        | è¯´æ˜                                                                                                       |
| ----------- | ---------------------------------------------------------------------------------------------------------- |
| pascal_case | å¸•æ–¯å¡æ‹¼å†™æ³•(å¤§é©¼å³°): æ‰€æœ‰å•è¯çš„é¦–å­—æ¯å¤§å†™ï¼Œç„¶åç›´æ¥è¿æ¥èµ·æ¥ï¼Œå•è¯ä¹‹é—´æ²¡æœ‰è¿æ¥ç¬¦                           |
| camel_case  | éª†é©¼æ‹¼å†™æ³•(å°é©¼å³°): ç¬¬ä¸€ä¸ªå•è¯çš„é¦–å­—æ¯å°å†™, åç»­æ‰€æœ‰å•è¯çš„é¦–å­—æ¯å¤§å†™ï¼Œç„¶åç›´æ¥è¿æ¥èµ·æ¥ï¼Œå•è¯ä¹‹é—´æ²¡æœ‰è¿æ¥ç¬¦ |
| kebab_case  | è¿å­—ç¬¦æ‹¼å†™æ³•: å„ä¸ªå•è¯æˆ–ç¼©å†™ä¹‹é—´ä»¥`-`åšé—´éš”                                                                |
| dashed_case | ç ´æŠ˜å·å¼: æ¯ä¸ªå•è¯å…¨å°å†™æˆ–å…¨å¤§å†™ï¼Œå¤šå•è¯ä½¿ç”¨`-`éš”å¼€                                                        |
| snake_case  | è›‡å½¢å‘½å: æ¯ä¸ªå•è¯å…¨å°å†™æˆ–å…¨å¤§å†™ï¼Œå¤šå•è¯ä½¿ç”¨`_`éš”å¼€                                                        |


### é…ç½®æ¡ˆä¾‹ MemberTransformer

```javascript
const conf = {
  importOnDemand: {
    /** åº“å */
    lodash: {
      transform: '${member}',
    },
    /** åº“å */
    antd: {
      transform: 'es/${member}',
      style: 'es/${member}/style',
      memberTransformers: ['dashed_case'],
    },
  },
};
// ä»¥ä¸‹ä»£ç å°†ä¼šæŒ‰ç…§é¢„æœŸè¿›è¡Œè½¬æ¢
import { BackTop } from 'antd';
import { isFunction } from 'lodash';
// to
import BackTop from 'antd/es/back-top';
import 'antd/es/back-top/style';
import isFunction from 'lodash/isFunction';
```

## æ¨¡å—è”é‚¦

> Webpack5 Module Federation

### ModuleFederationOption

| å±æ€§     | è¯´æ˜                                           | ç±»å‹                                                 | é»˜è®¤å€¼            |
| -------- | ---------------------------------------------- | ---------------------------------------------------- | ----------------- |
| name     | æ¨¡å—åç§°ï¼Œå”¯ä¸€æ€§ï¼Œä¸èƒ½é‡å                     | string                                               | -                 |
| filename | æ‰“åŒ…çš„æ¨¡å—æ–‡ä»¶å                               | string                                               | `remote_entry.js` |
| name     | æ¨¡å—åç§°ï¼Œå”¯ä¸€æ€§ï¼Œä¸èƒ½é‡å                     | string                                               | -                 |
| remotes  | è¡¨ç¤ºä½œä¸º Host æ—¶, å»æ¶ˆè´¹å“ªäº› Remote            | `ModuleFederationRemotes`[]                          | -                 |
| exposes  | å½“å‰æ¨¡å—å…·ä½“å¯¼å‡ºå»çš„å†…å®¹                       | `string` \| \{ name: `string`; path: `string`; }      | -                 |
| shared   | ä¼˜å…ˆç”¨ Host çš„ä¾èµ–, å¦‚æœ Host æ²¡æœ‰, å†ç”¨è‡ªå·±çš„ | `Record<string, SharedConfig \| string>`\|`string`[] | -                 |
| library  | library                                        | \{ type: `var` \| `string`; name: `string`; }         | -                 |
| runtime  | runtime                                        | string                                               | -                 |


### ModuleFederationRemotes

| å±æ€§     | è¯´æ˜                   | ç±»å‹       | é»˜è®¤å€¼            |
| -------- | ---------------------- | ---------- | ----------------- |
| name     | è¿œç¨‹æ¨¡å—åç§°           | string     | -                 |
| filename | è¿œç¨‹æ¨¡å—æ–‡ä»¶å         | string     | `remote_entry.js` |
| host     | è¿œç¨‹æ¨¡å—è®¿é—®åœ°å€       | string     | -                 |
| alias    | è¿œç¨‹æ¨¡å—åˆ«å           | string     | -                 |
| library  | ä»æ­¤æ¨¡å—åŠ è½½çš„ library | `string`[] | -                 |

### SharedConfig

| å±æ€§            | è¯´æ˜                                                                                                                   | ç±»å‹    | é»˜è®¤å€¼ |
| --------------- | ---------------------------------------------------------------------------------------------------------------------- | ------- | ------ |
| eager           | ç›´æ¥åœ¨å¼‚æ­¥è¯·æ±‚åé¢åŒ…å«æä¾›çš„å’Œåå¤‡æ¨¡å—,è¿™ä¹Ÿå…è®¸åœ¨åˆå§‹åŠ è½½ä¸­ä½¿ç”¨æ­¤å…±äº«æ¨¡å—,æ‰€æœ‰å¯èƒ½çš„å…±äº«æ¨¡å—ä¹Ÿéƒ½éœ€è¦æ€¥åˆ‡               | boolean | -      |
| import          | åº”æä¾›å…±äº«èŒƒå›´çš„æä¾›çš„æ¨¡å—,å¦‚æœåœ¨å…±äº«ä½œç”¨åŸŸä¸­æ‰¾ä¸åˆ°å…±äº«æ¨¡å—æˆ–ç‰ˆæœ¬æ— æ•ˆ,åˆ™è¿˜å……å½“å›é€€æ¨¡å—,é»˜è®¤ä¸ºå±æ€§åç§°                  | number  | -      |
| packageName     | è½¯ä»¶åŒ…åç§°,ç”¨äºä»æè¿°æ–‡ä»¶ä¸­ç¡®å®šæ‰€éœ€çš„ç‰ˆæœ¬,ä»…å½“æ— æ³•æ ¹æ®è¯·æ±‚è‡ªåŠ¨ç¡®å®šåŒ…åç§°æ—¶æ‰éœ€è¦                                       | string  | -      |
| requiredVersion | å…±äº«èŒƒå›´ä¸­æ¥è‡ªæ¨¡å—çš„ç‰ˆæœ¬è¦æ±‚                                                                                           | number  | -      |
| shareKey        | åœ¨å…±äº«èŒƒå›´å†…çš„æ­¤é”®ä¸‹æŸ¥æ‰¾æ¨¡å—                                                                                           | string  | -      |
| shareScope      | å…±äº«èŒƒå›´åç§°                                                                                                           | string  | -      |
| singleton       | åœ¨å…±äº«èŒƒå›´å†…ä»…å…è®¸å…±äº«æ¨¡å—çš„å•ä¸ªç‰ˆæœ¬(é»˜è®¤æƒ…å†µä¸‹å¤„äºç¦ç”¨çŠ¶æ€)                                                           | boolean | -      |
| strictVersion   | å¦‚æœç‰ˆæœ¬æ— æ•ˆ,åˆ™ä¸æ¥å—å…±äº«æ¨¡å—(é»˜è®¤ä¸ºæ˜¯,å¦‚æœæœ¬åœ°åå¤‡æ¨¡å—å¯ç”¨å¹¶ä¸”å…±äº«æ¨¡å—ä¸æ˜¯å•ä¾‹,å¦åˆ™ä¸º no,å¦‚æœæœªæŒ‡å®šæ‰€éœ€çš„ç‰ˆæœ¬,åˆ™æ— æ•ˆ) | boolean | -      |
| version         | æ‰€æä¾›æ¨¡å—çš„ç‰ˆæœ¬,å°†æ›¿æ¢è¾ƒä½çš„åŒ¹é…ç‰ˆæœ¬,ä½†ä¸ä¼šæ›¿æ¢è¾ƒé«˜çš„ç‰ˆæœ¬                                                             | number  | -      |

### é…ç½®æ¡ˆä¾‹ moduleFederation

```javascript
import type { ConfigType } from '@moneko/core';

const PACKAGENAME = process.env.npm_package_name; // å½“å‰package.jsonä¸­çš„name
const config: Partial<ConfigType> = {
  htmlPluginOption: {
    tags: [
      {
        textContent: `window.__RemoteEntry__={
          // æ¯”å¦‚ä½ å·²ç»æ„å»ºäº†ä¸€ä¸ª sharedLibrary ä½œä¸ºæ¨¡å—è”é‚¦çš„å…±äº«åº“
          sharedLibrary: '//å¯ä»¥è®¿é—® sharedLibrary çš„é“¾æ¥'
        };`,
      },
    ],
  },
  moduleFederation: [
    {
      name: PACKAGENAME.replace(/-/g, '_'),
      remotes: [
        {
          name: 'sharedLibrary',
          host: '[window.__RemoteEntry__.sharedLibrary]',
          // ä¸‹é¢çš„è¿™äº›æ¨¡å—åœ¨å°†é€šè¿‡ç½‘ç»œä½¿ç”¨sharedLibraryä¸­çš„èµ„æº,è€Œä¸æ˜¯æœ¬åœ°
          library: ['react', 'react-dom', 'react-router', 'react-router-dom', 'antd'],
        },
      ],
    },
  ],
};

export default config;
```

## è‡ªå®šä¹‰æ¨¡å—è§£æè§„åˆ™

```javascript
// config/index.ts
export default {
  moduleRules: [
    {
      test: /\.aaa$/,
      type: 'assets',
      exclude: [/node_modules/],
    },
  ],
};
```

## è‡ªå®šä¹‰ ts-loader é…ç½®

> åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª tsloader.config.ts

```javascript
// tsloader.config.ts
export default {};
```
